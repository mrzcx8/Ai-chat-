<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Suara Peribadi</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            height: 100vh;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .container {
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        h1 {
            color: #ffffff;
            margin-bottom: 20px;
        }

        .output-container {
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            min-height: 100px;
            text-align: left;
        }

        .instruction {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        button {
            background-color: #4CAF50;
            border: none;
            border-radius: 50px;
            color: white;
            padding: 12px 25px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 10px 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        .mic-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #ff4081;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
            transition: all 0.3s;
            cursor: pointer;
        }

        .mic-button:hover {
            background-color: #f50057;
            transform: scale(1.05);
        }

        .mic-icon {
            width: 40px;
            height: 40px;
            fill: white;
        }

        .listening {
            animation: pulse 1.5s infinite;
            background-color: #f50057;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 64, 129, 0.7);
            }
            70% {
                transform: scale(1.05);
                box-shadow: 0 0 0 20px rgba(255, 64, 129, 0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 64, 129, 0);
            }
        }

        .status {
            margin-top: 10px;
            font-style: italic;
            color: #e0e0e0;
        }
        
        .project-section {
            margin-top: 20px;
            text-align: left;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .project-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .debug-info {
            margin-top: 10px;
            font-size: 0.8rem;
            color: #e0e0e0;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 5px;
            border-radius: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI Suara Peribadi</h1>
        
        <div class="instruction">Klik butang mikrofon dan beritahu saya sesuatu. Saya boleh menjawab sapaan, memberitahu masa, dan berbincang tentang projek anda.</div>
        
        <div class="output-container" id="outputText">
            Selamat datang! Saya AI suara peribadi anda. Cuba katakan "Hai" atau "Pukul berapa sekarang?" atau "Apa projek kita hari ini?"
        </div>
        
        <div class="mic-button" id="micButton">
            <svg class="mic-icon" viewBox="0 0 24 24">
                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
            </svg>
        </div>
        
        <div class="status" id="statusText">Klik untuk mula bercakap</div>
        
        <div class="project-section">
            <div class="project-title">Projek Hari Ini:</div>
            <div id="projectText">Membuat aplikasi web AI suara interaktif</div>
        </div>
        
        <div class="debug-info" id="debugInfo"></div>
        
        <button id="testSpeechButton">Uji Ucapan</button>
    </div>

    <script>
        // Elemen-elemen UI
        const micButton = document.getElementById('micButton');
        const outputText = document.getElementById('outputText');
        const statusText = document.getElementById('statusText');
        const projectText = document.getElementById('projectText');
        const debugInfo = document.getElementById('debugInfo');
        const testSpeechButton = document.getElementById('testSpeechButton');
        
        // Fungsi untuk menambah info debug ke antara muka
        function addDebugInfo(info) {
            debugInfo.style.display = 'block';
            debugInfo.textContent += info + '\n';
        }
        
        // Semak sokongan Speech API
        let speechRecognitionSupported = false;
        let speechSynthesisSupported = false;
        
        if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
            speechRecognitionSupported = true;
            addDebugInfo("✓ Speech Recognition disokong");
        } else {
            addDebugInfo("✗ Speech Recognition TIDAK disokong");
        }
        
        if ('speechSynthesis' in window) {
            speechSynthesisSupported = true;
            addDebugInfo("✓ Speech Synthesis disokong");
        } else {
            addDebugInfo("✗ Speech Synthesis TIDAK disokong");
        }
        
        // Projek yang ditugaskan
        const todayProject = "Membuat aplikasi web AI suara interaktif";
        
        // Fungsi untuk mendapatkan masa dan tarikh semasa
        function getCurrentTimeAndDate() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            
            const daysOfWeek = ['Ahad', 'Isnin', 'Selasa', 'Rabu', 'Khamis', 'Jumaat', 'Sabtu'];
            const dayName = daysOfWeek[now.getDay()];
            
            const day = now.getDate();
            const months = ['Januari', 'Februari', 'Mac', 'April', 'Mei', 'Jun', 'Julai', 'Ogos', 'September', 'Oktober', 'November', 'Disember'];
            const month = months[now.getMonth()];
            const year = now.getFullYear();
            
            return {
                time: `${hours}:${minutes}`,
                date: `${dayName}, ${day} ${month} ${year}`
            };
        }
        
        // Fungsi untuk menuturkan teks
        function speak(text) {
            if (speechSynthesisSupported) {
                // Hentikan ucapan semasa jika ada
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                
                // Cuba gunakan suara dalam bahasa Melayu jika ada
                const voices = window.speechSynthesis.getVoices();
                const malayVoice = voices.find(voice => voice.lang.includes('ms') || voice.lang.includes('id'));
                
                if (malayVoice) {
                    utterance.voice = malayVoice;
                    utterance.lang = malayVoice.lang;
                } else {
                    // Jika tiada suara Melayu, cuba bahasa Inggeris
                    utterance.lang = 'en-US';
                }
                
                // Tambah handler untuk mengesan masalah
                utterance.onerror = (event) => {
                    addDebugInfo(`Ralat ucapan: ${event.error}`);
                };
                
                utterance.onstart = () => {
                    addDebugInfo("Bermula bercakap");
                };
                
                utterance.onend = () => {
                    addDebugInfo("Selesai bercakap");
                };
                
                window.speechSynthesis.speak(utterance);
            } else {
                // Jika ucapan tidak disokong, hanya paparkan teks
                outputText.innerText = text;
                addDebugInfo("Speech synthesis tidak disokong");
            }
        }
        
        // Fungsi untuk memproses ucapan dan memberikan respons
        function processCommand(command) {
            command = command.toLowerCase();
            addDebugInfo(`Memproses arahan: "${command}"`);
            
            // Sapaan
            if (command.includes('hai') || 
                command.includes('hello') || 
                command.includes('hi') || 
                command.includes('selamat') || 
                command.includes('apa khabar')) {
                
                const responses = [
                    "Hai! Apa khabar hari ini?",
                    "Selamat sejahtera! Ada yang boleh saya bantu?",
                    "Hai, senang berjumpa dengan anda!",
                    "Hello! Apa yang boleh saya bantu hari ini?"
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                outputText.innerText = response;
                speak(response);
            }
            
            // Masa dan tarikh
            else if (command.includes('masa') || 
                    command.includes('pukul') || 
                    command.includes('jam') || 
                    command.includes('hari ini') ||
                    command.includes('tarikh')) {
                
                const timeDate = getCurrentTimeAndDate();
                const response = `Sekarang pukul ${timeDate.time}. Hari ini adalah ${timeDate.date}.`;
                outputText.innerText = response;
                speak(response);
            }
            
            // Projek
            else if (command.includes('projek') || 
                    command.includes('tugas') || 
                    command.includes('kerja') ||
                    command.includes('buat hari ini')) {
                
                const response = `Projek kita hari ini adalah: ${todayProject}`;
                outputText.innerText = response;
                speak(response);
            }
            
            // Jika arahan tidak dikenali
            else {
                const responses = [
                    "Maaf, saya tidak memahaminya. Cuba katakan 'Hai', tanya tentang masa, atau tanya tentang projek hari ini.",
                    "Saya tidak pasti apa yang anda maksudkan. Anda boleh bertanya tentang masa atau projek hari ini.",
                    "Saya tidak dapat memproses permintaan itu. Cuba tanya saya tentang masa atau projek hari ini."
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                outputText.innerText = response;
                speak(response);
            }
        }
        
        // Butang ujian ucapan
        testSpeechButton.addEventListener('click', () => {
            speak("Ini adalah ujian suara. Jika anda boleh mendengar ini, bermakna sistem ucapan berfungsi dengan baik.");
        });
        
        // Memeriksa sama ada peranti menyokong pengecaman ucapan
        if (speechRecognitionSupported) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            // Cuba gunakan pelbagai bahasa untuk meningkatkan kebolehpercayaan
            recognition.lang = 'ms-MY';  // Bahasa Melayu - Malaysia
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;
            
            micButton.addEventListener('click', () => {
                if (micButton.classList.contains('listening')) {
                    recognition.stop();
                    micButton.classList.remove('listening');
                    statusText.innerText = "Klik untuk mula bercakap";
                    addDebugInfo("Pembacaan ucapan dihentikan");
                } else {
                    try {
                        recognition.start();
                        micButton.classList.add('listening');
                        statusText.innerText = "Mendengar...";
                        addDebugInfo("Pembacaan ucapan dimulakan");
                    } catch (err) {
                        addDebugInfo(`Ralat memulakan pembacaan: ${err.message}`);
                        statusText.innerText = "Ralat memulakan pembacaan";
                    }
                }
            });
            
            recognition.onresult = (event) => {
                const speechResult = event.results[0][0].transcript;
                statusText.innerText = `Anda berkata: "${speechResult}"`;
                addDebugInfo(`Ucapan dikesan: "${speechResult}"`);
                
                // Proses arahan
                processCommand(speechResult);
                
                micButton.classList.remove('listening');
                setTimeout(() => {
                    statusText.innerText = "Klik untuk mula bercakap";
                }, 3000);
            };
            
            recognition.onend = () => {
                micButton.classList.remove('listening');
                addDebugInfo("Sesi pembacaan ucapan berakhir");
            };
            
            recognition.onerror = (event) => {
                statusText.innerText = `Ralat: ${event.error}`;
                addDebugInfo(`Ralat pembacaan ucapan: ${event.error}`);
                micButton.classList.remove('listening');
            };
            
            recognition.onnomatch = () => {
                statusText.innerText = "Tiada ucapan dikesan";
                addDebugInfo("Tiada ucapan yang sepadan dikesan");
                micButton.classList.remove('listening');
            };
            
            // Simpan untuk mudah diakses
            window.recognition = recognition;
            
            // Cuba dapatkan kebenaran mikrofon dari awal
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(function(stream) {
                    addDebugInfo("✓ Kebenaran mikrofon diberikan");
                    stream.getTracks().forEach(track => track.stop());
                })
                .catch(function(err) {
                    addDebugInfo(`✗ Kebenaran mikrofon ditolak: ${err.message}`);
                });
                
        } else {
            statusText.innerText = "Maaf, penyemak imbas anda tidak menyokong pengecaman ucapan.";
            micButton.style.backgroundColor = "#cccccc";
            micButton.style.cursor = "not-allowed";
            testSpeechButton.disabled = false;
        }
        
        // Aktifkan debug mode untuk pembangunan
        debugInfo.style.display = 'block';
        
        // Muat senarai suara yang tersedia
        window.speechSynthesis.onvoiceschanged = () => {
            const voices = window.speechSynthesis.getVoices();
            addDebugInfo(`Jumlah suara tersedia: ${voices.length}`);
            
            // Cari suara Melayu jika ada
            const malayVoice = voices.find(voice => voice.lang.includes('ms') || voice.lang.includes('id'));
            if (malayVoice) {
                addDebugInfo(`Suara Melayu dijumpai: ${malayVoice.name} (${malayVoice.lang})`);
            } else {
                addDebugInfo("Tiada suara Melayu dijumpai");
            }
        };
        
        // Uji ucapan setelah laman dimuat
        window.addEventListener('load', function() {
            setTimeout(function() {
                speak("Sistem AI suara sudah sedia. Sila klik butang mikrofon untuk bercakap dengan saya.");
            }, 1000);
        });
    </script>
</body>
</html>
